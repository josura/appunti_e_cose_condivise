library(randomForest)
library(mlbench)
data("BreastCancer")
View(BreastCancer)
breast.data <- BreastCancer[1:length(names(BreastCancer))]
#convertiamo le colonne di stringhe in numeri
for(i in 1:(length(names(breast.data))-1))(
breast.data[,i]<-as.numeric(breast.data[,i])
)
breast.data$Id<-NULL
View(breast.data)
perc.split <- 0.75
nobs.training <- round(perc.split*nrow(breast.data))
#campioniamo con sample le posizioni casuali
sample.pos <-sample(1:nrow(breast.data),nobs.training)
breast.training <- breast.data[sample.pos,]
View(breast.training)
breast.test <- breast.data[-sample.pos,]
#come algoritmo iniziale vediamo CART
library(rpart)
?rpart
breast.cart <- rpart(Class ~ . ,data = breast.training)
breast.cart
randomForest(Class~.,breast.training)
?randomForest
#non gestisce gli na
randomForest( Class ~. , breast.training,na.action = "na.omit")
#non gestisce gli na
forestarand <- randomForest( Class ~. , breast.training,na.action = "na.omit")
forestarand
#non gestisce gli na
breast.rf <- randomForest( Class ~. , breast.training,na.action = "na.omit")
rm(forestarand)
plot(breast.rf)
#dal grafico notiamo che dopo un certo numero di trial non abbiamo più un miglioramento sensibile
#calcoliamo la accuratezza
rf.predict <- predict(breast.rf, breast.test, type = "class")
rf.predict
true.class <- BreastCancer[-sample.pos,"Class"]
rf.results <- data.frame(real= true.class,predicted=rf.predict)
rf.results
accuratezza.rf <- sum(rf.results$real==rf.results$predicted)/nrow(breast.test)
accuratezza
accuratezza.rf
rm(accuratezza.rf)
rf.giuste <- sum(rf.results$real==rf.results$predicted)
rf.results
rf.giuste <- sum(rf.results$real==rf.results$predicted,na.rm = T)
accuratezza.rf <- rf/nrow(breast.test)
accuratezza.rf <- rf.giuste/nrow(breast.test)
accuratezza.rf
?na.action
?randomForest
accuratezza.rf <- rf.giuste/nrow(breast.test,na.rm =T)
accuratezza.rf <- rf.giuste/nrow(breast.test,na.omit)
#naivebayes
library(e1071)
?naiveBayes
breast.naive <- naiveBayes(Class ~. ,breast.training)
breast.naive
breast.naive <- naiveBayes(Class ~. ,breast.training,type = c("class","raw"))
breast.naive
naive.predict <- predict(breast.naive, breast.test, type = "class")
naive.predict
naive.results <- data.frame(real= true.class,predicted=naive.predict)
naive.giuste <- sum(naive.results$real==naive.results$predicted,na.rm = T)
accuratezza.naive <- naive.giuste/nrow(breast.test)
accuratezza.naive
accuratezza.rf
#SVM
#è gia in e1071
breast.svm <- svm(Class ~. ,breast.training)
breast.svm
?svm
breast.svm.linear <- svm(Class ~. ,breast.training, kernel = "linear")
#SVM
#è gia in e1071
breast.svm <- svm(Class ~. ,breast.training, probability = T)
svm.predict <- predict(breast.svm,breast.test, type = "class")
svm.predict
svm.predict.linear <- predict(breast.svm.linear,breast.test, type = "class")
svm.predict
breast.svm.linear <- svm(Class ~. ,breast.training, kernel = "linear")
svm.predict <- predict(breast.svm,breast.test, type = "class")
svm.predict
svm.predict.linear <- predict(breast.svm.linear,breast.test, type = "class")
svm.predict
svm.results <- data.frame(real= true.class,predicted=svm.predict)
svm.results.linear <- data.frame(real= true.class,predicted=svm.predict.linear)
svm.giuste <- sum(svm.results$real==svm.results$predicted,na.rm = T)
true.class %in% svm.predict
nrow(true.class)
lenght(true.class)
length(true.class)
length(svm.predict)
true.class %in% svm.predict
true.class
svm.predict
#svm ha direttamente tolto gli na
true.class.no.na <- BreastCancer[as.numeric(names(svm.predict)),"Class"]
svm.results <- data.frame(real= true.class.no.na,predicted=svm.predict)
svm.results.linear <- data.frame(real= true.class.no.na,predicted=svm.predict.linear)
svm.giuste <- sum(svm.results$real==svm.results$predicted,na.rm = T)
svm.linear.giuste <- sum(svm.results.linear$real==svm.results.linear$predicted,na.rm = T)
accuratezza.svm <- svm.giuste/nrow(breast.test)
accuratezza.svm.linear <- svm.giuste.linear/nrow(breast.test)
accuratezza.svm
accuratezza.svm.linear <- svm.linear.giuste/nrow(breast.test)
accuratezza.svm
accuratezza.svm.linear
breast.svm.polinomial <- svm(Class ~. ,breast.training, kernel = "polinomial")
breast.svm.polinomial <- svm(Class ~. ,breast.training, kernel = "polynomial")
svm.predict <- predict(breast.svm,breast.test, type = "class")
svm.predict
svm.predict.linear <- predict(breast.svm.linear,breast.test, type = "class")
svm.predict.polinomial <- predict(breast.svm.polinomial,breast.test, type = "class")
svm.predict
#svm ha direttamente tolto gli na(nel caso di na.omit, in teoria dicono che si potrebbe usare na.exclude nella costruzione del modello, bisogna cercare bene, di default), dobbiamo andare a trovare il numero dei record, cioè dobbiamo identificarli
true.class.no.na <- BreastCancer[as.numeric(names(svm.predict)),"Class"]
svm.results <- data.frame(real= true.class.no.na,predicted=svm.predict)
svm.results.linear <- data.frame(real= true.class.no.na,predicted=svm.predict.linear)
svm.results.polinomial <- data.frame(real= true.class.no.na,predicted=svm.predict.polinomial)
svm.giuste <- sum(svm.results$real==svm.results$predicted,na.rm = T)
svm.linear.giuste <- sum(svm.results.linear$real==svm.results.linear$predicted,na.rm = T)
svm.linear.polinomial <- sum(svm.results.polinomi$real==svm.results.polinomial$predicted,na.rm = T)
svm.linear.polinomial <- sum(svm.results.polinomial$real==svm.results.polinomial$predicted,na.rm = T)
accuratezza.svm <- svm.giuste/nrow(breast.test)
accuratezza.svm.linear <- svm.linear.giuste/nrow(breast.test)
accuratezza.svm.polinomial <- svm.linear.polinomial/nrow(breast.test)
accuratezza.svm
accuratezza.svm.linear
accuratezza.svm.polinomial
#SVM
#è gia in e1071
breast.svm <- svm(Class ~. ,breast.training, probability = T)
breast.svm
breast.svm.linear <- svm(Class ~. ,breast.training, kernel = "linear")
breast.svm.polinomial <- svm(Class ~. ,breast.training, kernel = "polynomial")
breast.svm.sigmoid <- svm(Class ~. ,breast.training, kernel = "sigmoid")
svm.predict <- predict(breast.svm,breast.test, type = "class")
svm.predict
svm.predict.linear <- predict(breast.svm.linear,breast.test, type = "class")
svm.predict.polinomial <- predict(breast.svm.polinomial,breast.test, type = "class")
svm.predict.sigmoid <- predict(breast.svm.sigmoid,breast.test, type = "class")
svm.predict
#svm ha direttamente tolto gli na(nel caso di na.omit, in teoria dicono che si potrebbe usare na.exclude nella costruzione del modello, bisogna cercare bene, di default), dobbiamo andare a trovare il numero dei record, cioè dobbiamo identificarli
true.class.no.na <- BreastCancer[as.numeric(names(svm.predict)),"Class"]
svm.results <- data.frame(real= true.class.no.na,predicted=svm.predict)
svm.results.linear <- data.frame(real= true.class.no.na,predicted=svm.predict.linear)
svm.results.polinomial <- data.frame(real= true.class.no.na,predicted=svm.predict.polinomial)
svm.results.sigmoid <- data.frame(real= true.class.no.na,predicted=svm.predict.sigmoid)
svm.giuste <- sum(svm.results$real==svm.results$predicted,na.rm = T)
svm.linear.giuste <- sum(svm.results.linear$real==svm.results.linear$predicted,na.rm = T)
svm.linear.polinomial <- sum(svm.results.polinomial$real==svm.results.polinomial$predicted,na.rm = T)
svm.giuste.sigmoid <- sum(svm.results.sigmoid$real==svm.results.sigmoid$predicted,na.rm = T)
accuratezza.svm <- svm.giuste/nrow(breast.test)
accuratezza.svm.linear <- svm.linear.giuste/nrow(breast.test)
accuratezza.svm.polinomial <- svm.linear.polinomial/nrow(breast.test)
accuratezza.svm.sigmoid <- svm.linear.sigmoid/nrow(breast.test)
accuratezza.svm.sigmoid <- svm.giuste.sigmoid/nrow(breast.test)
accuratezza.svm
accuratezza.svm.linear
accuratezza.svm.polinomial
accuratezza.svm.sigmoid
#knn
library(class)
breast.knn <- knn(breast.training,breast.training,k=10)
breast.knn <- knn(breast.training,k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-(ncol(breast.training)-1)],breast.test[complete.cases(breast.test),-(ncol(breast.test)-1)],k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-(ncol(breast.training)-1)],breast.test[complete.cases(breast.test),-(ncol(breast.test)-1)], cl= breast.training[complete.cases(breast.training)],k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-(ncol(breast.training)-1)],breast.test[complete.cases(breast.test),-(ncol(breast.test)-1)], cl= breast.training[complete.cases(breast.training),],k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-(ncol(breast.training)-1)],breast.test[complete.cases(breast.test),-(ncol(breast.test)-1)], cl= breast.training[complete.cases(breast.training),-10],k=10)
?knn
breast.training[complete.cases(breast.training)]
breast.training[complete.cases(breast.training),]
breast.test[complete.cases(breast.test),]
breast.training[complete.cases(breast.training),-(ncol(breast.training)-1)]
breast.training[complete.cases(breast.training)-(ncol(breast.training)-1),]
breast.training[complete.cases(breast.training)-(ncol(breast.training)-2),]
breast.training[complete.cases(breast.training),]
breast.training[,]
breast.training[complete.cases(breast.training),]
breast.training[,]
breast.training[complete.cases(breast.training),]
breast.training[complete.cases(breast.training),-10]
breast.training[complete.cases(breast.training),-ncol(breast.training)]
breast.training[complete.cases(breast.training),-ncol(breast.training)]
breast.knn <- knn(breast.training[complete.cases(breast.training)-(ncol(breast.training)),],breast.test[complete.cases(breast.test),-(ncol(breast.test))], cl= breast.training[complete.cases(breast.training),breast.training$Class],k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-ncol(breast.training))],breast.test[complete.cases(breast.test),-(ncol(breast.test))], cl= breast.training[complete.cases(breast.training),breast.training$Class],k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-ncol(breast.training)],breast.test[complete.cases(breast.test),-(ncol(breast.test))], cl= breast.training[complete.cases(breast.training),breast.training$Class],k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-ncol(breast.training)],breast.test[complete.cases(breast.test),-(ncol(breast.test))], cl= breast.training[complete.cases(breast.training),],k=10)
breast.knn <- knn(breast.training[complete.cases(breast.training),-ncol(breast.training)],breast.test[complete.cases(breast.test),-(ncol(breast.test))], cl= breast.training[complete.cases(breast.training),ncol(breast.training)],k=10)
breast.knn
